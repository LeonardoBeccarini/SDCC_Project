# usare il docker interno al cluster
eval $(minikube -p minikube docker-env)

# build immagini
docker build -t sdcc/gateway:latest ./internal/services/gateway
docker build -t sdcc/dashboard:latest ./dashboard_service

# apply k8s
kubectl apply -f k8s/cloud/namespace.yaml
kubectl apply -n cloud -f k8s/cloud/influx-secret.yaml
kubectl apply -f k8s/cloud/gateway.yaml
kubectl apply -f k8s/cloud/dashboard.yaml

# verifica
kubectl -n cloud get pods -o wide
kubectl -n cloud logs deploy/gateway -f
kubectl -n cloud logs deploy/dashboard -f
